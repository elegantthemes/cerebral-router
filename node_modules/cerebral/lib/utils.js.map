{"version":3,"sources":["../src/utils.js"],"names":["getChangedProps","cleanPath","isObject","isComplexObject","isSerializable","ensurePath","throwError","isDeveloping","delay","forceSerializable","getProviders","dependencyMatch","getWithPath","ensureStrictPath","createResolver","createDummyController","addCerebralStateKey","getStateTreeProp","getModule","extractModuleProp","propsA","propsB","propsAKeys","Object","keys","propsBKeys","changedProps","i","length","push","path","replace","obj","Array","isArray","value","additionalTypes","validType","reduce","currentValid","type","undefined","prototype","toString","call","constructor","getPrototypeOf","split","message","Error","process","env","NODE_ENV","func","wait","args","context","later","apply","setTimeout","name","defineProperty","e","module","assign","providers","modules","nestedProviders","moduleKey","extractAllChildMatches","children","matches","key","concat","changes","dependencyMap","currentMatches","changeIndex","currentDependencyMapLevel","pathKeyIndex","dependency","forceChildPathUpdates","currentValue","index","indexOf","getters","isTag","arg","types","isType","isCompute","overrideProps","getValue","props","getPath","noop","state","signals","getState","currentState","pathKey","options","on","model","get","getSignal","signal","componentDependencyStore","addEntity","removeEntity","object","__CerebralState","hit","pathArray","currentModule","join","splice","prop","transform","extracted","additionalExtracted","subModuleKey","extracedWithGetters","currentExtracted","propertyDescriptor","getOwnPropertyDescriptor"],"mappings":";;;;;;;;;QAGgBA,e,GAAAA,e;QAoBAC,S,GAAAA,S;QAIAC,Q,GAAAA,Q;QAIAC,e,GAAAA,e;QAIAC,c,GAAAA,c;QA2BAC,U,GAAAA,U;QAUAC,U,GAAAA,U;QAIAC,Y,GAAAA,Y;QAIAC,K,GAAAA,K;QAWAC,iB,GAAAA,iB;QAgBAC,Y,GAAAA,Y;QAwBAC,e,GAAAA,e;QA4DAC,W,GAAAA,W;QAcAC,gB,GAAAA,gB;QAQAC,c,GAAAA,c;QA+CAC,qB,GAAAA,qB;QAuBAC,mB,GAAAA,mB;QAeAC,gB,GAAAA,gB;QAcAC,S,GAAAA,S;QAgBAC,iB,GAAAA,iB;;AAxUhB;;AACA;;AAEO,SAASnB,eAAT,GAAmD;AAAA,MAA1BoB,MAA0B,uEAAjB,EAAiB;AAAA,MAAbC,MAAa,uEAAJ,EAAI;;AACxD,MAAMC,aAAaC,OAAOC,IAAP,CAAYJ,MAAZ,CAAnB;AACA,MAAMK,aAAaF,OAAOC,IAAP,CAAYH,MAAZ,CAAnB;AACA,MAAMK,eAAe,EAArB;;AAEA,OAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIL,WAAWM,MAA/B,EAAuCD,GAAvC,EAA4C;AAC1C,QAAIP,OAAOE,WAAWK,CAAX,CAAP,MAA0BN,OAAOC,WAAWK,CAAX,CAAP,CAA9B,EAAqD;AACnDD,mBAAaG,IAAb,CAAkB,EAAEC,MAAM,CAACR,WAAWK,CAAX,CAAD,CAAR,EAAlB;AACD;AACF;;AAED,OAAK,IAAIA,KAAI,CAAb,EAAgBA,KAAIF,WAAWG,MAA/B,EAAuCD,IAAvC,EAA4C;AAC1C,QAAIP,OAAOK,WAAWE,EAAX,CAAP,MAA0BN,OAAOI,WAAWE,EAAX,CAAP,CAA9B,EAAqD;AACnDD,mBAAaG,IAAb,CAAkB,EAAEC,MAAM,CAACL,WAAWE,EAAX,CAAD,CAAR,EAAlB;AACD;AACF;;AAED,SAAOD,YAAP;AACD;;AAEM,SAASzB,SAAT,CAAmB6B,IAAnB,EAAyB;AAC9B,SAAO,OAAOA,IAAP,KAAgB,QAAhB,GAA2BA,KAAKC,OAAL,CAAa,aAAb,EAA4B,EAA5B,CAA3B,GAA6DD,IAApE;AACD;;AAEM,SAAS5B,QAAT,CAAkB8B,GAAlB,EAAuB;AAC5B,SAAO,QAAOA,GAAP,yCAAOA,GAAP,OAAe,QAAf,IAA2BA,QAAQ,IAAnC,IAA2C,CAACC,MAAMC,OAAN,CAAcF,GAAd,CAAnD;AACD;;AAEM,SAAS7B,eAAT,CAAyB6B,GAAzB,EAA8B;AACnC,SAAO,QAAOA,GAAP,yCAAOA,GAAP,OAAe,QAAf,IAA2BA,QAAQ,IAA1C;AACD;;AAEM,SAAS5B,cAAT,CAAwB+B,KAAxB,EAAqD;AAAA,MAAtBC,eAAsB,uEAAJ,EAAI;;AAC1D,MAAMC,YAAYD,gBAAgBE,MAAhB,CAAuB,UAACC,YAAD,EAAeC,IAAf,EAAwB;AAC/D,QAAID,gBAAgBJ,iBAAiBK,IAArC,EAA2C;AACzC,aAAO,IAAP;AACD;;AAED,WAAOD,YAAP;AACD,GANiB,EAMf,KANe,CAAlB;;AAQA,MACEJ,UAAUM,SAAV,KACCJ,aACEnC,SAASiC,KAAT,KACCZ,OAAOmB,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+BT,KAA/B,MAA0C,iBAD3C,KAEEA,MAAMU,WAAN,KAAsBtB,MAAtB,IACCA,OAAOuB,cAAP,CAAsBX,KAAtB,MAAiC,IAHpC,CADF,IAKC,OAAOA,KAAP,KAAiB,QALlB,IAMC,OAAOA,KAAP,KAAiB,QANlB,IAOC,OAAOA,KAAP,KAAiB,SAPlB,IAQCA,UAAU,IARX,IASCF,MAAMC,OAAN,CAAcC,KAAd,CAVF,CADF,EAYE;AACA,WAAO,IAAP;AACD;AACD,SAAO,KAAP;AACD;;AAEM,SAAS9B,UAAT,GAA+B;AAAA,MAAXyB,IAAW,uEAAJ,EAAI;;AACpC,MAAIG,MAAMC,OAAN,CAAcJ,IAAd,CAAJ,EAAyB;AACvB,WAAOA,IAAP;AACD,GAFD,MAEO,IAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AACnC,WAAOA,KAAKiB,KAAL,CAAW,GAAX,CAAP;AACD;;AAED,SAAO,EAAP;AACD;;AAEM,SAASzC,UAAT,CAAoB0C,OAApB,EAA6B;AAClC,QAAM,IAAIC,KAAJ,iBAAwBD,OAAxB,CAAN;AACD;;AAEM,SAASzC,YAAT,GAAwB;AAC7B,SAAO2C,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,YAAhC;AACD;;AAEM,SAAS5C,KAAT,CAAe6C,IAAf,EAAqBC,IAArB,EAA2B;AAChC,SAAO,YAAkB;AAAA,sCAANC,IAAM;AAANA,UAAM;AAAA;;AACvB,QAAMC,UAAU,IAAhB;AACA,QAAMC,QAAQ,SAARA,KAAQ,GAAM;AAClBJ,WAAKK,KAAL,CAAWF,OAAX,EAAoBD,IAApB;AACD,KAFD;;AAIAI,eAAWF,KAAX,EAAkBH,IAAlB;AACD,GAPD;AAQD;;AAEM,SAAS7C,iBAAT,CAA2B0B,KAA3B,EAAkC;AACvC,MAAIA,SAAS,CAAC/B,eAAe+B,KAAf,CAAd,EAAqC;AACnC,QAAMyB,OAAOzB,MAAMU,WAAN,CAAkBe,IAA/B;;AAEA,QAAI;AACFrC,aAAOsC,cAAP,CAAsB1B,KAAtB,EAA6B,QAA7B,EAAuC;AACrCA,aADqC,mBAC7B;AACN,uBAAWyB,IAAX;AACD;AAHoC,OAAvC;AAKD,KAND,CAME,OAAOE,CAAP,EAAU,CAAE;AACf;;AAED,SAAO3B,KAAP;AACD;;AAEM,SAASzB,YAAT,CAAsBqD,MAAtB,EAA8B;AACnC,SAAOxC,OAAOyC,MAAP,CACLD,OAAOE,SAAP,IAAoB,EADf,EAEL1C,OAAOC,IAAP,CAAYuC,OAAOG,OAAP,IAAkB,EAA9B,EAAkC5B,MAAlC,CAAyC,UAAC6B,eAAD,EAAkBC,SAAlB,EAAgC;AACvE,WAAO7C,OAAOyC,MAAP,CACLG,eADK,EAELzD,aAAaqD,OAAOG,OAAP,CAAeE,SAAf,CAAb,CAFK,CAAP;AAID,GALD,EAKG,EALH,CAFK,CAAP;AASD;;AAED,SAASC,sBAAT,CAAgCC,QAAhC,EAA0C;AACxC,SAAO/C,OAAOC,IAAP,CAAY8C,QAAZ,EAAsBhC,MAAtB,CAA6B,UAACiC,OAAD,EAAUC,GAAV,EAAkB;AACpD,QAAIF,SAASE,GAAT,EAAcF,QAAlB,EAA4B;AAC1B,aAAOC,QACJE,MADI,CACGH,SAASE,GAAT,CADH,EAEJC,MAFI,CAEGJ,uBAAuBC,SAASE,GAAT,EAAcF,QAArC,CAFH,CAAP;AAGD;;AAED,WAAOC,QAAQE,MAAR,CAAeH,SAASE,GAAT,CAAf,CAAP;AACD,GARM,EAQJ,EARI,CAAP;AASD;;AAEM,SAAS7D,eAAT,CAAyB+D,OAAzB,EAAkCC,aAAlC,EAAiD;AACtD,MAAIC,iBAAiB,EAArB;;AAEA,OAAK,IAAIC,cAAc,CAAvB,EAA0BA,cAAcH,QAAQ9C,MAAhD,EAAwDiD,aAAxD,EAAuE;AACrE,QAAIC,4BAA4BH,aAAhC;AACA,SACE,IAAII,eAAe,CADrB,EAEEA,eAAeL,QAAQG,WAAR,EAAqB/C,IAArB,CAA0BF,MAF3C,EAGEmD,cAHF,EAIE;AACA,UAAI,CAACD,yBAAL,EAAgC;AAC9B;AACD;;AAED,UAAIA,0BAA0B,IAA1B,CAAJ,EAAqC;AACnCF,uBAAe/C,IAAf,CAAoBiD,0BAA0B,IAA1B,CAApB;AACD;;AAED,UAAIC,iBAAiBL,QAAQG,WAAR,EAAqB/C,IAArB,CAA0BF,MAA1B,GAAmC,CAAxD,EAA2D;AACzD,YAAMoD,aACJF,0BAA0BJ,QAAQG,WAAR,EAAqB/C,IAArB,CAA0BiD,YAA1B,CAA1B,CADF;AAEA,YAAIC,UAAJ,EAAgB;AACdJ,yBAAe/C,IAAf,CAAoBmD,UAApB;;AAEA,cAAIA,WAAWV,QAAf,EAAyB;AACvB,gBAAII,QAAQG,WAAR,EAAqBI,qBAAzB,EAAgD;AAC9CL,+BAAiBA,eAAeH,MAAf,CACfJ,uBAAuBW,WAAWV,QAAlC,CADe,CAAjB;AAGD,aAJD,MAIO;AACL,kBAAIU,WAAWV,QAAX,CAAoB,IAApB,CAAJ,EAA+B;AAC7BM,+BAAe/C,IAAf,CAAoBmD,WAAWV,QAAX,CAAoB,IAApB,CAApB;AACD;;AAED,kBAAIU,WAAWV,QAAX,CAAoB,GAApB,CAAJ,EAA8B;AAC5BM,+BAAe/C,IAAf,CAAoBmD,WAAWV,QAAX,CAAoB,GAApB,CAApB;AACD;AACF;AACF;AACF;;AAED,YAAIQ,0BAA0B,GAA1B,CAAJ,EAAoC;AAClCF,yBAAe/C,IAAf,CAAoBiD,0BAA0B,GAA1B,CAApB;AACD;AACF;;AAED,UAAI,CAACA,0BAA0BJ,QAAQG,WAAR,EAAqB/C,IAArB,CAA0BiD,YAA1B,CAA1B,CAAL,EAAyE;AACvED,oCAA4B,IAA5B;AACA;AACD;;AAEDA,kCACEA,0BAA0BJ,QAAQG,WAAR,EAAqB/C,IAArB,CAA0BiD,YAA1B,CAA1B,EACGT,QAFL;AAGD;AACF;;AAED,SAAOM,cAAP;AACD;;AAEM,SAAShE,WAAT,CAAqBoB,GAArB,EAA0B;AAC/B,SAAO,UAACF,IAAD,EAAU;AACf,WAAOA,KAAKiB,KAAL,CAAW,GAAX,EAAgBT,MAAhB,CAAuB,UAAC4C,YAAD,EAAeV,GAAf,EAAoBW,KAApB,EAA8B;AAC1D,UAAIA,QAAQ,CAAR,IAAaD,iBAAiBzC,SAAlC,EAA6C;AAC3CnC,sDACmCwB,IADnC;AAGD;;AAED,aAAOoD,aAAaV,GAAb,CAAP;AACD,KARM,EAQJxC,GARI,CAAP;AASD,GAVD;AAWD;;AAEM,SAASnB,gBAAT,CAA0BiB,IAA1B,EAAgCK,KAAhC,EAAuC;AAC5C,MAAIhC,gBAAgBgC,KAAhB,KAA0BL,KAAKsD,OAAL,CAAa,GAAb,MAAsB,CAAC,CAArD,EAAwD;AACtD,WAAUtD,IAAV;AACD;;AAED,SAAOA,IAAP;AACD;;AAEM,SAAShB,cAAT,CAAwBuE,OAAxB,EAAiC;AACtC,SAAO;AACLC,SADK,iBACCC,GADD,EACgB;AACnB,UAAI,EAAEA,wBAAF,CAAJ,EAA2B;AACzB,eAAO,KAAP;AACD;;AAHkB,yCAAPC,KAAO;AAAPA,aAAO;AAAA;;AAKnB,UAAIA,MAAM5D,MAAV,EAAkB;AAChB,eAAO4D,MAAMlD,MAAN,CAAa,UAACmD,MAAD,EAASjD,IAAT,EAAkB;AACpC,iBAAOiD,UAAUjD,SAAS+C,IAAI/C,IAA9B;AACD,SAFM,EAEJ,KAFI,CAAP;AAGD;;AAED,aAAO,IAAP;AACD,KAbI;AAcLkD,aAdK,qBAcKH,GAdL,EAcU;AACb,aAAOA,+BAAP;AACD,KAhBI;AAiBLpD,SAjBK,iBAiBCoD,GAjBD,EAiBMI,aAjBN,EAiBqB;AACxB,UAAIJ,4BAAsBA,+BAA1B,EAAkD;AAChD,eAAOA,IAAIK,QAAJ,CACLD,gBACIpE,OAAOyC,MAAP,CAAc,EAAd,EAAkBqB,OAAlB,EAA2B,EAAEQ,OAAOF,aAAT,EAA3B,CADJ,GAEIN,OAHC,CAAP;AAKD;;AAED,aAAOE,GAAP;AACD,KA3BI;AA4BLzD,QA5BK,gBA4BAyD,GA5BA,EA4BK;AACR,UAAIA,wBAAJ,EAAwB;AACtB,eAAOA,IAAIO,OAAJ,CAAYT,OAAZ,CAAP;AACD;;AAED/E,iBAAW,8DAAX;AACD;AAlCI,GAAP;AAoCD;;AAEM,IAAMyF,sBAAO,SAAPA,IAAO,GAAM,CAAE,CAArB;;AAEP;;;;;;AAMO,SAAShF,qBAAT,GAAyD;AAAA,MAA1BiF,KAA0B,uEAAlB,EAAkB;AAAA,MAAdC,OAAc,uEAAJ,EAAI;;AAC9D,MAAMC,WAAW,SAAXA,QAAW,CAACpE,IAAD,EAAU;AACzB,WAAOzB,WAAWyB,IAAX,EAAiBQ,MAAjB,CAAwB,UAAC6D,YAAD,EAAeC,OAAf,EAA2B;AACxD,aAAOD,eAAeA,aAAaC,OAAb,CAAf,GAAuC3D,SAA9C;AACD,KAFM,EAEJuD,KAFI,CAAP;AAGD,GAJD;AAKA,SAAO;AACLK,aAAS,EADJ;AAELC,MAFK,gBAEA,CAAE,CAFF;;AAGLJ,sBAHK;AAILK,WAAO;AACLC,WAAKN;AADA,KAJF;AAOLO,aAPK,qBAOKC,MAPL,EAOa;AAChB,aAAOT,QAAQS,MAAR,KAAoB,YAAM,CAAE,CAAnC;AACD,KATI;;AAULC,8BAA0B;AACxBC,iBAAWb,IADa;AAExBc,oBAAcd;AAFU;AAVrB,GAAP;AAeD;;AAEM,SAAS/E,mBAAT,CAA6B8F,MAA7B,EAAqC;AAC1C,MAAI3G,gBAAgB2G,MAAhB,CAAJ,EAA6B;AAC3B,SAAK,IAAMtC,GAAX,IAAkBsC,MAAlB,EAA0B;AACxB9F,0BAAoB8F,OAAOtC,GAAP,CAApB;AACD;;AAED,KAACsC,OAAOC,eAAR,IACExF,OAAOsC,cAAP,CAAsBiD,MAAtB,EAA8B,iBAA9B,EAAiD;AAC/C3E,aAAO;AADwC,KAAjD,CADF;AAID;;AAED,SAAO2E,MAAP;AACD;;AAEM,SAAS7F,gBAAT,GAAsC;AAAA,MAAZ4E,KAAY,uEAAJ,EAAI;;AAC3C,SAAOtE,OAAOC,IAAP,CAAYqE,KAAZ,EAAmBvD,MAAnB,CAA0B,UAAC0E,GAAD,EAAMxC,GAAN,EAAc;AAC7C,QACE,CAACwC,GAAD,IACA7G,gBAAgB0F,MAAMrB,GAAN,CAAhB,CADA,IAEA,qBAAqBqB,MAAMrB,GAAN,CAHvB,EAIE;AACA,aAAOA,GAAP;AACD;;AAED,WAAOwC,GAAP;AACD,GAVM,EAUJ,IAVI,CAAP;AAWD;;AAEM,SAAS9F,SAAT,CAAmBY,IAAnB,EAAyBoC,OAAzB,EAAkC;AACvC,MAAM+C,YAAYhF,MAAMC,OAAN,CAAcJ,IAAd,IAAsBA,IAAtB,GAA6BzB,WAAWyB,IAAX,CAA/C;AACA,SAAOmF,UAAU3E,MAAV,CAAiB,UAAC4E,aAAD,EAAgB1C,GAAhB,EAAwB;AAC9C,QAAI,CAAC0C,cAAchD,OAAd,CAAsBM,GAAtB,CAAL,EAAiC;AAC/BlE,gCACe2G,UAAUE,IAAV,CACX,GADW,CADf,0DAGwDF,UACnDG,MADmD,CAC5C,CAD4C,EACzCtF,KAAKF,MAAL,GAAc,CAD2B,EAEnDuF,IAFmD,CAE9C,GAF8C,CAHxD;AAOD;AACD,WAAOD,cAAchD,OAAd,CAAsBM,GAAtB,CAAP;AACD,GAXM,EAWJN,OAXI,CAAP;AAYD;;AAEM,SAAS/C,iBAAT,CAA2B4C,MAA3B,EAAmCsD,IAAnC,EAAyCC,SAAzC,EAAoD;AACzD,MAAMC,YAAYhG,OAAOC,IAAP,CAAYuC,OAAOG,OAAP,IAAkB,EAA9B,EAAkC5B,MAAlC,CAChB,UAACkF,mBAAD,EAAsBC,YAAtB,EAAuC;AACrCD,wBAAoBC,YAApB,IAAoCtG,kBAClC4C,OAAOG,OAAP,CAAeuD,YAAf,CADkC,EAElCJ,IAFkC,EAGlCC,SAHkC,CAApC;;AAMA,WAAOE,mBAAP;AACD,GATe,EAUhB,EAVgB,CAAlB;;AAaA,MAAIzD,OAAOsD,IAAP,CAAJ,EAAkB;AAChB,QAAMK,sBAAsBnG,OAAOC,IAAP,CAAYuC,OAAOsD,IAAP,CAAZ,EAA0B/E,MAA1B,CAC1B,UAACqF,gBAAD,EAAmBnD,GAAnB,EAA2B;AACzB,UAAMoD,qBAAqBrG,OAAOsG,wBAAP,CACzB9D,OAAOsD,IAAP,CADyB,EAEzB7C,GAFyB,CAA3B;AAIA,UAAIoD,sBAAsB,SAASA,kBAAnC,EAAuD;AACrDrG,eAAOsC,cAAP,CAAsB8D,gBAAtB,EAAwCnD,GAAxC,EAA6CoD,kBAA7C;AACD,OAFD,MAEO;AACLD,yBAAiBnD,GAAjB,IAAwBT,OAAOsD,IAAP,EAAa7C,GAAb,CAAxB;AACD;;AAED,aAAOmD,gBAAP;AACD,KAbyB,EAc1BJ,SAd0B,CAA5B;;AAiBA,WAAOD,YACHA,UAAUI,mBAAV,EAA+B3D,MAA/B,CADG,GAEH2D,mBAFJ;AAGD;;AAED,SAAOH,SAAP;AACD","file":"utils.js","sourcesContent":["import { Tag } from './tags'\nimport { Compute } from './Compute'\n\nexport function getChangedProps(propsA = {}, propsB = {}) {\n  const propsAKeys = Object.keys(propsA)\n  const propsBKeys = Object.keys(propsB)\n  const changedProps = []\n\n  for (let i = 0; i < propsAKeys.length; i++) {\n    if (propsA[propsAKeys[i]] !== propsB[propsAKeys[i]]) {\n      changedProps.push({ path: [propsAKeys[i]] })\n    }\n  }\n\n  for (let i = 0; i < propsBKeys.length; i++) {\n    if (propsA[propsBKeys[i]] !== propsB[propsBKeys[i]]) {\n      changedProps.push({ path: [propsBKeys[i]] })\n    }\n  }\n\n  return changedProps\n}\n\nexport function cleanPath(path) {\n  return typeof path === 'string' ? path.replace(/\\.\\*\\*|\\.\\*/, '') : path\n}\n\nexport function isObject(obj) {\n  return typeof obj === 'object' && obj !== null && !Array.isArray(obj)\n}\n\nexport function isComplexObject(obj) {\n  return typeof obj === 'object' && obj !== null\n}\n\nexport function isSerializable(value, additionalTypes = []) {\n  const validType = additionalTypes.reduce((currentValid, type) => {\n    if (currentValid || value instanceof type) {\n      return true\n    }\n\n    return currentValid\n  }, false)\n\n  if (\n    value !== undefined &&\n    (validType ||\n      (isObject(value) &&\n        Object.prototype.toString.call(value) === '[object Object]' &&\n        (value.constructor === Object ||\n          Object.getPrototypeOf(value) === null)) ||\n      typeof value === 'number' ||\n      typeof value === 'string' ||\n      typeof value === 'boolean' ||\n      value === null ||\n      Array.isArray(value))\n  ) {\n    return true\n  }\n  return false\n}\n\nexport function ensurePath(path = []) {\n  if (Array.isArray(path)) {\n    return path\n  } else if (typeof path === 'string') {\n    return path.split('.')\n  }\n\n  return []\n}\n\nexport function throwError(message) {\n  throw new Error(`Cerebral - ${message}`)\n}\n\nexport function isDeveloping() {\n  return process.env.NODE_ENV !== 'production'\n}\n\nexport function delay(func, wait) {\n  return function(...args) {\n    const context = this\n    const later = () => {\n      func.apply(context, args)\n    }\n\n    setTimeout(later, wait)\n  }\n}\n\nexport function forceSerializable(value) {\n  if (value && !isSerializable(value)) {\n    const name = value.constructor.name\n\n    try {\n      Object.defineProperty(value, 'toJSON', {\n        value() {\n          return `[${name}]`\n        },\n      })\n    } catch (e) {}\n  }\n\n  return value\n}\n\nexport function getProviders(module) {\n  return Object.assign(\n    module.providers || {},\n    Object.keys(module.modules || {}).reduce((nestedProviders, moduleKey) => {\n      return Object.assign(\n        nestedProviders,\n        getProviders(module.modules[moduleKey])\n      )\n    }, {})\n  )\n}\n\nfunction extractAllChildMatches(children) {\n  return Object.keys(children).reduce((matches, key) => {\n    if (children[key].children) {\n      return matches\n        .concat(children[key])\n        .concat(extractAllChildMatches(children[key].children))\n    }\n\n    return matches.concat(children[key])\n  }, [])\n}\n\nexport function dependencyMatch(changes, dependencyMap) {\n  let currentMatches = []\n\n  for (let changeIndex = 0; changeIndex < changes.length; changeIndex++) {\n    let currentDependencyMapLevel = dependencyMap\n    for (\n      let pathKeyIndex = 0;\n      pathKeyIndex < changes[changeIndex].path.length;\n      pathKeyIndex++\n    ) {\n      if (!currentDependencyMapLevel) {\n        break\n      }\n\n      if (currentDependencyMapLevel['**']) {\n        currentMatches.push(currentDependencyMapLevel['**'])\n      }\n\n      if (pathKeyIndex === changes[changeIndex].path.length - 1) {\n        const dependency =\n          currentDependencyMapLevel[changes[changeIndex].path[pathKeyIndex]]\n        if (dependency) {\n          currentMatches.push(dependency)\n\n          if (dependency.children) {\n            if (changes[changeIndex].forceChildPathUpdates) {\n              currentMatches = currentMatches.concat(\n                extractAllChildMatches(dependency.children)\n              )\n            } else {\n              if (dependency.children['**']) {\n                currentMatches.push(dependency.children['**'])\n              }\n\n              if (dependency.children['*']) {\n                currentMatches.push(dependency.children['*'])\n              }\n            }\n          }\n        }\n\n        if (currentDependencyMapLevel['*']) {\n          currentMatches.push(currentDependencyMapLevel['*'])\n        }\n      }\n\n      if (!currentDependencyMapLevel[changes[changeIndex].path[pathKeyIndex]]) {\n        currentDependencyMapLevel = null\n        break\n      }\n\n      currentDependencyMapLevel =\n        currentDependencyMapLevel[changes[changeIndex].path[pathKeyIndex]]\n          .children\n    }\n  }\n\n  return currentMatches\n}\n\nexport function getWithPath(obj) {\n  return (path) => {\n    return path.split('.').reduce((currentValue, key, index) => {\n      if (index > 0 && currentValue === undefined) {\n        throwError(\n          `You are extracting with path \"${path}\", but it is not valid for this object`\n        )\n      }\n\n      return currentValue[key]\n    }, obj)\n  }\n}\n\nexport function ensureStrictPath(path, value) {\n  if (isComplexObject(value) && path.indexOf('*') === -1) {\n    return `${path}.**`\n  }\n\n  return path\n}\n\nexport function createResolver(getters) {\n  return {\n    isTag(arg, ...types) {\n      if (!(arg instanceof Tag)) {\n        return false\n      }\n\n      if (types.length) {\n        return types.reduce((isType, type) => {\n          return isType || type === arg.type\n        }, false)\n      }\n\n      return true\n    },\n    isCompute(arg) {\n      return arg instanceof Compute\n    },\n    value(arg, overrideProps) {\n      if (arg instanceof Tag || arg instanceof Compute) {\n        return arg.getValue(\n          overrideProps\n            ? Object.assign({}, getters, { props: overrideProps })\n            : getters\n        )\n      }\n\n      return arg\n    },\n    path(arg) {\n      if (arg instanceof Tag) {\n        return arg.getPath(getters)\n      }\n\n      throwError('You are extracting a path from an argument that is not a Tag')\n    },\n  }\n}\n\nexport const noop = () => {}\n\n/*\n  When testing and running on the server there is no need to\n  initialize all of Cerebral. So by not passing a controller\n  to this Container it will create a dummy version which inserts\n  state and mocks any signals when connecting the component.\n*/\nexport function createDummyController(state = {}, signals = {}) {\n  const getState = (path) => {\n    return ensurePath(path).reduce((currentState, pathKey) => {\n      return currentState ? currentState[pathKey] : undefined\n    }, state)\n  }\n  return {\n    options: {},\n    on() {},\n    getState,\n    model: {\n      get: getState,\n    },\n    getSignal(signal) {\n      return signals[signal] || (() => {})\n    },\n    componentDependencyStore: {\n      addEntity: noop,\n      removeEntity: noop,\n    },\n  }\n}\n\nexport function addCerebralStateKey(object) {\n  if (isComplexObject(object)) {\n    for (const key in object) {\n      addCerebralStateKey(object[key])\n    }\n\n    !object.__CerebralState &&\n      Object.defineProperty(object, '__CerebralState', {\n        value: true,\n      })\n  }\n\n  return object\n}\n\nexport function getStateTreeProp(props = {}) {\n  return Object.keys(props).reduce((hit, key) => {\n    if (\n      !hit &&\n      isComplexObject(props[key]) &&\n      '__CerebralState' in props[key]\n    ) {\n      return key\n    }\n\n    return hit\n  }, null)\n}\n\nexport function getModule(path, modules) {\n  const pathArray = Array.isArray(path) ? path : ensurePath(path)\n  return pathArray.reduce((currentModule, key) => {\n    if (!currentModule.modules[key]) {\n      throwError(\n        `The path \"${pathArray.join(\n          '.'\n        )}\" is invalid, can not find module. Does the path \"${pathArray\n          .splice(0, path.length - 1)\n          .join('.')}\" exist?`\n      )\n    }\n    return currentModule.modules[key]\n  }, modules)\n}\n\nexport function extractModuleProp(module, prop, transform) {\n  const extracted = Object.keys(module.modules || {}).reduce(\n    (additionalExtracted, subModuleKey) => {\n      additionalExtracted[subModuleKey] = extractModuleProp(\n        module.modules[subModuleKey],\n        prop,\n        transform\n      )\n\n      return additionalExtracted\n    },\n    {}\n  )\n\n  if (module[prop]) {\n    const extracedWithGetters = Object.keys(module[prop]).reduce(\n      (currentExtracted, key) => {\n        const propertyDescriptor = Object.getOwnPropertyDescriptor(\n          module[prop],\n          key\n        )\n        if (propertyDescriptor && 'get' in propertyDescriptor) {\n          Object.defineProperty(currentExtracted, key, propertyDescriptor)\n        } else {\n          currentExtracted[key] = module[prop][key]\n        }\n\n        return currentExtracted\n      },\n      extracted\n    )\n\n    return transform\n      ? transform(extracedWithGetters, module)\n      : extracedWithGetters\n  }\n\n  return extracted\n}\n"]}