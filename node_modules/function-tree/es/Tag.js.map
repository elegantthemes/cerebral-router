{"version":3,"sources":["../src/Tag.js"],"names":["ResolveValue","Tag","type","getter","strings","values","concat","getNestedTags","context","reduce","currentPath","string","idx","valueTemplate","getValue","undefined","getPath","currentPaths","pathToString","toString","createTemplateTag","tag","some","value","Error"],"mappings":";;;;;;;;AAAA,SAASA,YAAT,QAA6B,gBAA7B;;AAEA;;;AAGA,WAAaC,GAAb;AAAA;;AACE,eAAYC,IAAZ,EAAkBC,MAAlB,EAA0BC,OAA1B,EAAmCC,MAAnC,EAA2C;AAAA;;AAAA;;AAEzC,UAAKH,IAAL,GAAYA,IAAZ;AACA,UAAKC,MAAL,GAAcA,MAAd;AACA,UAAKC,OAAL,GAAeA,OAAf;AACA,UAAKC,MAAL,GAAcA,MAAd;AALyC;AAM1C;AACD;;;;;;AARF;AAAA;AAAA,8BAYY;AACR,aAAO,CAAC,IAAD,EAAOC,MAAP,CAAc,KAAKC,aAAL,EAAd,CAAP;AACD;AACD;;;;AAfF;AAAA;AAAA,4BAkBUC,OAlBV,EAkBmB;AAAA;;AACf,aAAO,KAAKJ,OAAL,CAAaK,MAAb,CAAoB,UAACC,WAAD,EAAcC,MAAd,EAAsBC,GAAtB,EAA8B;AACvD,YAAMC,gBAAgB,OAAKR,MAAL,CAAYO,GAAZ,CAAtB;;AAEA,YAAIC,yBAAyBb,YAA7B,EAA2C;AACzC,iBAAOU,cAAcC,MAAd,GAAuBE,cAAcC,QAAd,CAAuBN,OAAvB,CAA9B;AACD;;AAED,eACEE,cACAC,MADA,IAECE,kBAAkBE,SAAlB,GAA8BF,aAA9B,GAA8C,EAF/C,CADF;AAKD,OAZM,EAYJ,EAZI,CAAP;AAaD;AAhCH;AAAA;AAAA,6BAiCWL,OAjCX,EAiCoB;AAChB,aAAO,KAAKL,MAAL,CAAY,KAAKa,OAAL,CAAaR,OAAb,CAAZ,EAAmCA,OAAnC,CAAP;AACD;AACD;;;;AApCF;AAAA;AAAA,oCAuCkB;AAAA;;AACd,aAAO,KAAKJ,OAAL,CAAaK,MAAb,CAAoB,UAACQ,YAAD,EAAeN,MAAf,EAAuBC,GAAvB,EAA+B;AACxD,YAAMC,gBAAgB,OAAKR,MAAL,CAAYO,GAAZ,CAAtB;;AAEA,YAAIC,yBAAyBZ,GAA7B,EAAkC;AAChC,iBAAOgB,aAAaX,MAAb,CAAoBO,aAApB,CAAP;AACD;;AAED,eAAOI,YAAP;AACD,OARM,EAQJ,EARI,CAAP;AASD;AACD;;;;AAlDF;AAAA;AAAA,+BAqDa;AACT,aAAO,KAAKf,IAAL,GAAY,GAAZ,GAAkB,KAAKgB,YAAL,EAAlB,GAAwC,GAA/C;AACD;AACD;;;;AAxDF;AAAA;AAAA,mCA2DiB;AAAA;;AACb,aAAO,KAAKd,OAAL,CAAaK,MAAb,CAAoB,UAACC,WAAD,EAAcC,MAAd,EAAsBC,GAAtB,EAA8B;AACvD,YAAMC,gBAAgB,OAAKR,MAAL,CAAYO,GAAZ,CAAtB;;AAEA,YAAIC,yBAAyBZ,GAA7B,EAAkC;AAChC,iBAAOS,cAAcC,MAAd,GAAuB,IAAvB,GAA8BE,cAAcM,QAAd,EAA9B,GAAyD,GAAhE;AACD;;AAED,eACET,cACAC,MADA,IAECE,kBAAkBE,SAAlB,GAA8BF,aAA9B,GAA8C,EAF/C,CADF;AAKD,OAZM,EAYJ,EAZI,CAAP;AAaD;AAzEH;;AAAA;AAAA,EAAyBb,YAAzB;;AA4EA,OAAO,SAASoB,iBAAT,CAA2BC,GAA3B,EAAgCP,QAAhC,EAA0C;AAC/C,SAAO,UAACV,OAAD,EAAwB;AAAA,sCAAXC,MAAW;AAAXA,YAAW;AAAA;;AAC7B,QAAIA,OAAOiB,IAAP,CAAY,UAACC,KAAD;AAAA,aAAWA,UAAUR,SAArB;AAAA,KAAZ,CAAJ,EAAiD;AAC/C,YAAM,IAAIS,KAAJ,CACJ,kFADI,CAAN;AAGD;AACD,WAAO,IAAIvB,GAAJ,CAAQoB,GAAR,EAAaP,QAAb,EAAuBV,OAAvB,EAAgCC,MAAhC,CAAP;AACD,GAPD;AAQD","file":"Tag.js","sourcesContent":["import { ResolveValue } from './ResolveValue'\n\n/*\n  Creates tag for targetting things with a path in Cerebral\n*/\nexport class Tag extends ResolveValue {\n  constructor(type, getter, strings, values) {\n    super()\n    this.type = type\n    this.getter = getter\n    this.strings = strings\n    this.values = values\n  }\n  /*\n    Returns all tags, also nested to identify nested state dependencies\n    in components\n  */\n  getTags() {\n    return [this].concat(this.getNestedTags())\n  }\n  /*\n    Gets the path of the tag, where nested tags are evaluated\n  */\n  getPath(context) {\n    return this.strings.reduce((currentPath, string, idx) => {\n      const valueTemplate = this.values[idx]\n\n      if (valueTemplate instanceof ResolveValue) {\n        return currentPath + string + valueTemplate.getValue(context)\n      }\n\n      return (\n        currentPath +\n        string +\n        (valueTemplate !== undefined ? valueTemplate : '')\n      )\n    }, '')\n  }\n  getValue(context) {\n    return this.getter(this.getPath(context), context)\n  }\n  /*\n    Grab nested tags from the tags current path\n  */\n  getNestedTags() {\n    return this.strings.reduce((currentPaths, string, idx) => {\n      const valueTemplate = this.values[idx]\n\n      if (valueTemplate instanceof Tag) {\n        return currentPaths.concat(valueTemplate)\n      }\n\n      return currentPaths\n    }, [])\n  }\n  /*\n    Produces a string representation of the tag\n  */\n  toString() {\n    return this.type + '`' + this.pathToString() + '`'\n  }\n  /*\n    Produces a string representation of the path\n  */\n  pathToString() {\n    return this.strings.reduce((currentPath, string, idx) => {\n      const valueTemplate = this.values[idx]\n\n      if (valueTemplate instanceof Tag) {\n        return currentPath + string + '${' + valueTemplate.toString() + '}'\n      }\n\n      return (\n        currentPath +\n        string +\n        (valueTemplate !== undefined ? valueTemplate : '')\n      )\n    }, '')\n  }\n}\n\nexport function createTemplateTag(tag, getValue) {\n  return (strings, ...values) => {\n    if (values.some((value) => value === undefined)) {\n      throw new Error(\n        'One of the values passed inside the tag interpolated to undefined. Please check.'\n      )\n    }\n    return new Tag(tag, getValue, strings, values)\n  }\n}\n"]}